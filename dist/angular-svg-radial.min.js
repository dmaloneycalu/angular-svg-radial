/*!
 * angular-svg-radial 0.2.0
 * (c) 2016 Vokal LLC
 * https://github.com/vokal/angular-svg-radial
 */
angular.module("svgRadial",[]).directive("asrWrap",[function(){"use strict";return{restrict:"E",replace:!0,transclude:!0,templateUrl:"templates/asrRadial.html",scope:{rotation:"&",values:"="},controller:function(){var a=this;a.strokes=[],a.largestStroke=0,a.addStroke=function(b){a.strokes.push(b),b>a.largestStroke&&(a.largestStroke=b)}},link:function(a,b,c,d){if(!a.values)return!1;var e=b[0].offsetWidth;a.asr={center:Math.floor(e/2),fin:function(){return a.values.reduce(function(a,b){return a+b},0)>=100},radius:function(){return Math.max(a.asr.center-Math.ceil(d.largestStroke/2),0)},style:{height:e+"px"}},a.$watch(function(){return b[0].offsetWidth},function(b){e=b,a.asr.center=Math.floor(e/2),a.asr.style.height=e+"px"});var f=0;a.asr.values=a.values.map(function(a){var b={percent:100>=f+a?a:100-f,offset:f};return f+=b.percent,b})}}}]).directive("asrCircle",["$window","$timeout",function(a,b){"use strict";return{restrict:"E",templateNamespace:"svg",replace:!0,require:"^asrWrap",templateUrl:"templates/asrCircle.html",scope:{c:"=",r:"=rad",rotation:"=",percent:"=",offset:"="},link:function(c,d,e,f){var g=a.getComputedStyle(d[0]).strokeWidth;f.addStroke(Number(g.slice(0,g.indexOf("px")))),c.diam=function(){return 2*c.r*Math.PI},c.transformOffset=function(){return 3.6*c.offset+(c.rotation||0)},c.strokeOffset=function(){return c.percent>=100?0:c.diam()-c.percent/100*c.diam()},b(function(){d.addClass("ready")},100)}}}]),angular.module("svgRadial").run(["$templateCache",function(a){"use strict";a.put("templates/asrCircle.html",'<circle ng-attr-r="{{ r }}" ng-attr-cx="{{ c }}" ng-attr-cy="{{ c }}" ng-attr-stroke-dasharray="{{ diam() }}" ng-attr-stroke-dashoffset="{{ strokeOffset() }}" ng-attr-transform="rotate( {{ transformOffset() }}, {{ c }}, {{ c }} )" ng-class="{ \'negative\': percent < 0 }" ng-hide="percent == 0">'),a.put("templates/asrRadial.html",'<div class="asr-wrap" ng-style="asr.style" ng-show="values.length"><svg class="asr-svg" ng-style="asr.style" ng-class="{ finished: asr.fin() }"><asr-circle c="asr.center" rad="asr.radius()" percent="100" offset="0" class="asr-base"></asr-circle><g><asr-circle class="asr-radial" ng-repeat="val in asr.values" c="asr.center" offset="val.offset" percent="val.percent" rad="asr.radius()" rotation="rotation()"></asr-circle></g></svg><div ng-transclude></div></div>')}]);